---
const BASE = import.meta.env.BASE_URL || '/';
---
<nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
  <div class="container px-4 px-lg-5">
    <a class="navbar-brand" href={BASE}>æ´›ç©¹åçš„ä¸€å®¶è¨€</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
      aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto py-4 py-lg-0">
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href={BASE}>Home</a></li>
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href=`${BASE}about/`>About</a></li>
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href=`${BASE}articles/`>Articles</a></li>
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href=`${BASE}tools/`>Tools</a></li>
        <li class="nav-item ms-lg-3 theme-toggle-item">
          <button class="btn btn-sm theme-toggle" type="button" id="themeToggle" aria-pressed="false" title="Toggle theme">
            ğŸŒ™
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<script is:inline>
(() => {
  if (typeof window === 'undefined') return;
  const KEY = 'theme-preference';
  const root = document.documentElement;
  const btn = document.getElementById('themeToggle');
  if (!btn) return;

  const apply = (mode) => {
    const isDark = mode === 'dark';
    root.classList.toggle('theme-dark', isDark);
    btn.setAttribute('aria-pressed', String(isDark));
    btn.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
  };

  const stored = localStorage.getItem(KEY);
  const systemPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  let mode = stored || (systemPrefersDark ? 'dark' : 'light');
  apply(mode);

  btn.addEventListener('click', () => {
    mode = mode === 'dark' ? 'light' : 'dark';
    localStorage.setItem(KEY, mode);
    apply(mode);
  });
})();
</script>
